vars:

    s3-accounts-file: &s3-accounts-file s3://s3bucket/ValidAccountNumbers.csv



policies:


- name: aws-ami-cross-account-reporting-pull
  resource: aws.ami
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS AMIs which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your AMIs. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-artifact-domain-cross-account-reporting-pull
  resource: aws.artifact-domain
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS artifact domains which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your artifact domains. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-artifact-repo-cross-account-reporting-pull
  resource: aws.artifact-repo
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for artifact repositories which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your artifact repositories These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict




- name: aws-catalog-portfolio-cross-account-reporting-pull
  resource: aws.catalog-portfolio
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Catalog Portfolios which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Catalog Portfolios These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-config-recorder-cross-account-reporting-pull
  resource: aws.config-recorder
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Config Recorders which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Config Recorders These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-ebs-snapshot-cross-account-reporting-pull
  resource: aws.ebs-snapshot
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS EBS snapshots which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your EBS snapshots. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-ecr-cross-account-reporting-pull
  resource: aws.ecr
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS ECR registry which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your ECR registry. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-elasticsearch-cross-account-reporting-pull
  resource: aws.elasticsearch
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Elasticsearch Domains which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Elasticsearch Domains. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict








- name: aws-event-bus-cross-account-reporting-pull
  resource: aws.event-bus
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Event Busses which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Event Busses. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-event-rule-target-cross-account-reporting-pull
  resource: aws.event-rule-target
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Event Rule targets which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Event Rule targets. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-glacier-cross-account-reporting-pull
  resource: aws.glacier
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Glacier Vaults which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Glacier Vaults. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-glue-catalog-cross-account-reporting-pull
  resource: aws.glue-catalog
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Glue Catalogs which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Glue Catalogs. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-iam-role-cross-account-reporting-pull
  resource: aws.iam-role
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS IAM Roles which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your IAM Roles. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-kms-cross-account-reporting-pull
  resource: aws.kms
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS KMS Keystores which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your KMS Keystores. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-kms-key-cross-account-reporting-pull
  resource: aws.kms-key
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS KMS Keys which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your KMS Keys. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-lambda-cross-account-reporting-pull
  resource: aws.lambda
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Lambda functions which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Lambda functions. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-lambda-layer-cross-account-reporting-pull
  resource: aws.lambda-layer
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Lambda Layers which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Lambda Layers. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict




- name: aws-log-group-cross-account-reporting-pull
  resource: aws.log-group
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS CloudWatch Log Groups which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your CloudWatch Log Groups. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-peering-connection-cross-account-reporting-pull
  resource: aws.peering-connection
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Peering connections which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Peering connections. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-rds-cluster-snapshot-cross-account-reporting-pull
  resource: aws.rds-cluster-snapshot
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS RDS Cluster Snapshots which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your RDS Cluster Snapshots. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict



- name: aws-rds-snapshot-cross-account-reporting-pull
  resource: aws.rds-snapshot
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS RDS Snapshots which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your RDS Snapshots. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-redshift-snapshot-cross-account-reporting-pull
  resource: aws.redshift-snapshot
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Redshift Snapshots which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Redshift Snapshots. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-rest-api-cross-account-reporting-pull
  resource: aws.rest-api
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Rest APIs which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Rest APIs. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict







- name: aws-s3-cross-account-reporting-pull
  resource: aws.s3
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS S3 Buckets which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your S3 Buckets. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-secrets-manager-cross-account-reporting-pull
  resource: aws.secrets-manager
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Secrets Manager Secrets which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Secrets Manager Secrets. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict






- name: aws-serverless-app-cross-account-reporting-pull
  resource: aws.serverless-app
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS Serverless applications which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your Serverless applications. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-sns-cross-account-reporting-pull
  resource: aws.sns
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS SNS Topics which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your SNS Topics. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict




- name: aws-sqs-cross-account-reporting-pull
  resource: aws.sqs
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS SQS queues which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your SQS queues. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict





- name: aws-vpc-endpoint-cross-account-reporting-pull
  resource: aws.vpc-endpoint
  metadata:
    category: [security/access-control]
    compliance:
      - type: CCM
        version: 3.0.1
        control-mappings: [IAM-07,IVS-08]
    creator: Stacklet
    severity: high
  description: |
    This policy will check for AWS VPC endpoints which are either public facing or
    granting permissions to accounts outside of the organizations trusted
    accounts. Cross-account or public permissions should be restricted as they
    can allow unauthorized users to access your VPC endpoints. These unauthorized
    permissions should be removed to meet AWS security best practices and secure
    your environment.
  filters:
    - type: cross-account
      whitelist_from:
          url: *s3-accounts-file
          format: csv2dict
