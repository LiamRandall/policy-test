policies:
  - name: aws-sqs-cross-account-permissions
    tags:
      - Category::Security
      - Compliance::PCI DSS
      - Compliance::APRA
      - Compliance::MAS
      - Compliance::NIST 800-53
      - Risk::High
    resource: sqs
    filters:
      - type: cross-account
        everyone_only: false
        whitelist_from:
            url: "{whitelist_url}"
            format: csv
            expr: 0
    actions:
      - type: remove-statements
        statement_ids: matched
      - type: notify
        template: default.html
        priority_header: 1
        subject: "SQS Queue - Unauthorized Cross Account Access Removed - [custodian {{ account }} - {{ region }}]"
        owner_absent_contact:
            - "{missingcontact}"
        to:
            - resource-owner
            - event-owner
        transport:
            type: sqs
            queue: "{mailer_queue_url}"
            region: "{region}"
