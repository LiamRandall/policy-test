policies:


- name: aws-acm-certificate-auto-tag-user
  resource: aws.acm-certificate
  description: |
    Tags the creator's ID to the CreatorName tag on the ACM certificate
  mode:
    type: cloudtrail
    events:
        - source: "acm.amazonaws.com"
          event: "RequestCertificate"
          ids: "responseElements.certificateArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-ami-auto-tag-user
  resource: aws.ami
  description: |
    Tags the creator's ID to the CreatorName tag on the AMI
  mode:
    type: cloudtrail
    events:
        - source: "ec2.amazonaws.com"
          event: "CreateImage"
          ids: "responseElements.imageId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-app-elb-auto-tag-user
  resource: aws.app-elb
  description: |
    Tags the user ID who created the App ELB resource
  mode:
    type: cloudtrail
    events:
        - source: "elbv2.amazonaws.com"
          event: CreateLoadBalancer
          ids: "requestParameters.name"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-app-elb-target-group-auto-tag-user
  resource: aws.app-elb-target-group
  description: |
    Tags the user ID who created the App ELB target group resource
  mode:
    type: cloudtrail
    events:
        - source: "elbv2.amazonaws.com"
          event: CreateTargetGroup
          ids: "responseElements.targetGroups[].targetGroupArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-app-flow-auto-tag-user
  resource: aws.app-flow
  description: |
    Tags the user ID who created the App Flow resource
  mode:
    type: cloudtrail
    events:
        - source: "appflow.amazonaws.com"
          event: CreateFlow
          ids: "requestParameters.flowName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-asg-auto-tag-user
  resource: aws.asg
  description: |
     Tags the user who created the ASG
  mode:
     type: cloudtrail
     events:
        - CreateAutoScalingGroup
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName



- name: aws-backup-plan-auto-tag-user
  resource: aws.backup-plan
  description: |
     Tags the user who created the backup plan
  mode:
     type: cloudtrail
     events:
        - source: backup.amazonaws.com
          event: CreateBackupPlan
          ids: "responseElements.backupPlanId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName



- name: aws-backup-vault-auto-tag-user
  resource: aws.backup-vault
  description: |
     Tags the user who created the backup vault
  mode:
     type: cloudtrail
     events:
        - source: backup.amazonaws.com
          event: CreateBackupVault
          ids: "requestParameters.backupVaultName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-cache-cluster-auto-tag-user
  resource: aws.cache-cluster
  description: |
     Tags the user who created the cache cluster
  mode:
     type: cloudtrail
     events:
        - source: elasticache.amazonaws.com
          event: CreateCacheCluster
          ids: "requestParameters.cacheClusterId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-cache-snapshot-auto-tag-user
  resource: aws.cache-snapshot
  description: |
     Tags the user who created the cache snapshot
  mode:
     type: cloudtrail
     events:
        - source: elasticache.amazonaws.com
          event: CreateSnapshot
          ids: "requestParameters.snapshotName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-catalog-portfolio-auto-tag-user
  resource: aws.catalog-portfolio
  description: |
     Tags the user who created the catalog portfolio
  mode:
     type: cloudtrail
     events:
        - source: servicecatalog.amazonaws.com
          event: CreatePortfolio
          ids: "responseElements.portfolioDetail.id"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-cft-auto-tag-user
  resource: aws.cfn
  description: |
    Tags the user who creates the CloudFormation Template
  mode:
      type: cloudtrail
      events:
        - source: cloudformation.amazonaws.com
          event: CreateStack
          ids: "requestParameters.stackName"
  filters:
    - "tag:CreatorName": absent
    - or:
        - "StackStatus": "CREATE_COMPLETE"
        - "StackStatus": "UPDATE_COMPLETE"
        - "StackStatus": "UPDATE_ROLLBACK_COMPLETE"
        - "StackStatus": "IMPORT_COMPLETE"
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-cloud-directory-auto-tag-user
  resource: aws.cloud-directory
  mode:
     type: cloudtrail
     events:
        - source: clouddirectory.amazonaws.com
          event: CreateDirectory
          ids: "responseElements.directoryArn"
  description: |
     Tags the user who creates the Cloud Directory
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-cloudhsm-cluster-auto-tag-user
  resource: aws.cloudhsm-cluster
  mode:
     type: cloudtrail
     events:
        - source: cloudhsm.amazonaws.com
          event: CreateHsm
          ids: "requestParameters.clusterId"
  description: |
     Tags the user who creates the Cloud HSM cluster
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-cloudfront-auto-tag-user
  resource: aws.distribution
  mode:
     type: cloudtrail
     events:
        - source: cloudfront.amazonaws.com
          event: CreateDistribution
          ids: "responseElements.distribution.id"
  description: |
     when a new distribution is created it will
     automatically be tagged with the creators ID
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-cloudtrail-auto-tag-user
  resource: aws.cloudtrail
  description: |
    Tags the user who creates the Cloudtrail.
  mode:
      type: cloudtrail
      events:
        - source: cloudtrail.amazonaws.com
          event: CreateTrail
          ids: "requestParameters.name"
  filters:
     - "tag:CreatorName": absent
  actions:
     - type: auto-tag-user
       tag: CreatorName





- name: aws-codebuild-auto-tag-user
  description: |
      Tags newly created CodeBuild Projects with the Creators Id.
  resource: aws.codebuild
  mode:
      type: cloudtrail
      events:
        - source: codebuild.amazonaws.com
          event: CreateProject
          ids: "responseElements.project.name"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-codecommit-auto-tag-user
  description: |
      Tags newly created Code Commit Repository with the Creators Id.
  resource: aws.codecommit
  mode:
      type: cloudtrail
      events:
        - source: codecommit.amazonaws.com
          event: CreateRepository
          ids: "requestParameters.repositoryName"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-codepipeline-auto-tag-user
  description: |
      Tags newly created Code Pipeline with the Creators Id.
  resource: aws.codepipeline
  mode:
      type: cloudtrail
      events:
        - source: codepipeline.amazonaws.com
          event: CreatePipeline
          ids: "requestParameters.pipeline.name"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-config-rule-auto-tag-user
  description: |
      Tags newly created Config Rule with the Creators Id.
  resource: aws.config-rule
  mode:
      type: cloudtrail
      events:
        - source: config.amazonaws.com
          event: PutConfigRule
          ids: "requestParameters.configRule.configRuleName"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-customer-gateway-auto-tag-user
  description: |
      Tags newly created Customer Gateway with the Creators Id.
  resource: aws.customer-gateway
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: CreateCustomerGateway
          ids: "responseElements.customerGateway.customerGatewayId"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-datapipeline-auto-tag-user
  description: |
      Tags newly created Data Pipeline with the Creators Id.
  resource: aws.datapipeline
  mode:
      type: cloudtrail
      events:
        - source: datapipeline.amazonaws.com
          event: CreatePipeline
          ids: "responseElements.pipelineId"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-dax-auto-tag-user
  description: |
      Tags newly created Dax with the Creators Id.
  resource: aws.dax
  mode:
      type: cloudtrail
      events:
        - source: dax.amazonaws.com
          event: CreateCluster
          ids: "requestParameters.clusterName"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-directconnect-auto-tag-user
  description: |
      Tags newly created Direct Connect connections with the Creators Id.
  resource: aws.directconnect
  mode:
      type: cloudtrail
      events:
        - source: directconnect.amazonaws.com
          event: CreateConnection
          ids: "responseElements.connectionId"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-directory-auto-tag-user
  resource: aws.directory
  mode:
     type: cloudtrail
     events:
        - source: ds.amazonaws.com
          event: CreateDirectory
          ids: "responseElements.DirectoryId"
  description: |
     Tags the user who creates the AWS Directory
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-dms-endpoint-auto-tag-user
  resource: aws.dms-endpoint
  mode:
     type: cloudtrail
     events:
        - source: dms.amazonaws.com
          event: CreateEndpoint
          ids: "responseElements.endpoint.endpointArn"
  description: |
     Tags the user who creates the AWS DMS Endpoint
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-dms-instance-auto-tag-user
  resource: aws.dms-instance
  mode:
     type: cloudtrail
     events:
        - source: dms.amazonaws.com
          event: CreateReplicationInstance
          ids: "requestParameters.replicationInstanceIdentifier"
  description: |
     Tags the user who creates the AWS DMS Instance
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-dynamodb-table-auto-tag-user
  resource: aws.dynamodb-table
  description: |
    Tags the user who created the DynamoDB Table at launch.
  mode:
    type: cloudtrail
    events:
      - CreateTable
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-ebs-auto-tag-user
  resource: aws.ebs
  mode:
     type: cloudtrail
     events:
        - source: ec2.amazonaws.com
          event: CreateVolume
          ids: "responseElements.volumeId"
  description: |
     Tags the user who creates the AWS EBS volume
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-ebs-snapshot-auto-tag-user
  resource: aws.ebs-snapshot
  mode:
     type: cloudtrail
     events:
        - source: ec2.amazonaws.com
          event: CreateSnapshot
          ids: "responseElements.snapshotId"
  description: |
     Tags the user who creates the AWS EBS snapshot
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-ec2-auto-tag-user
  resource: aws.ec2
  description: |
     Tag any new instance with the Creators ID
  mode:
    type: cloudtrail
    events:
      - RunInstances
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-ec2-start-instance-auto-tag-user
  resource: aws.ec2
  mode:
     type: cloudtrail
     events:
        - source: ec2.amazonaws.com
          event: StartInstances
          ids: "responseElements.instancesSet.items[].instanceId"
  description: |
    Tags the last user to start the EC2 instance
  actions:
    - type: auto-tag-user
      tag: ServerStartedBy




- name: aws-ec2-stopped-instance-auto-tag-user
  resource: ec2
  mode:
     type: cloudtrail
     events:
        - source: ec2.amazonaws.com
          event: StopInstances
          ids: "responseElements.instancesSet.items[].instanceId"
  description: |
    Tags the user which last stopped the EC2 instance.
  actions:
    - type: auto-tag-user
      tag: ServerStoppedBy



- name: aws-ecr-auto-tag-user
  resource: aws.ecr
  description: |
     Tags the user who creates the AWS ECR
  mode:
     type: cloudtrail
     events:
        - source: ecr.amazonaws.com
          event: CreateRepository
          ids: "requestParameters.repositoryName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-ecs-auto-tag-user
  resource: aws.ecs
  description: |
     Tags the user who creates the AWS ECS cluster
  mode:
     type: cloudtrail
     events:
        - source: ecs.amazonaws.com
          event: CreateCluster
          ids: "responseElements.cluster.clusterArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName







- name: aws-ecs-service-auto-tag-user
  resource: aws.ecs-service
  description: |
     Tags the user who creates the AWS ECS service
  mode:
     type: cloudtrail
     events:
        - source: ecs.amazonaws.com
          event: CreateService
          ids: "responseElements.service.serviceArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-ecs-task-definition-auto-tag-user
  resource: aws.ecs-task-definition
  description: |
     Tags the user who creates the AWS ECS task definition
  mode:
     type: cloudtrail
     events:
        - source: ecs.amazonaws.com
          event: RegisterTaskDefinition
          ids: "responseElements.taskDefinition.taskDefinitionArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-efs-auto-tag-user
  resource: aws.efs
  description: |
     when a new efs is created it will
     automatically be tagged with the creators ID
  mode:
     type: cloudtrail
     events:
        - source: elasticfilesystem.amazonaws.com
          event: CreateFileSystem
          ids: "responseElements.fileSystemId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-eks-auto-tag-user
  resource: aws.eks
  description: |
     Tags the user who creates the AWS EKS cluster
  mode:
     type: cloudtrail
     events:
        - source: eks.amazonaws.com
          event: CreateCluster
          ids: "requestParameters.name"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-elastic-ip-auto-tag-user
  resource: aws.elastic-ip
  description: |
     Tags the user who creates the AWS Elastic IP
  mode:
     type: cloudtrail
     events:
        - source: ec2.amazonaws.com
          event: AllocateAddress
          ids: "responseElements.allocationId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-elasticbeanstalk-environment-auto-tag-user
  resource: aws.elasticbeanstalk-environment
  description: |
     Tags the user who creates the AWS Elastic Beanstalk environment
  mode:
     type: cloudtrail
     events:
        - source: elasticbeanstalk.amazonaws.com
          event: CreateEnvironment
          ids: "requestParameters.environmentName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-elb-auto-tag-user
  resource: aws.elb
  description: |
    Tags the creator's ID to the CreatorName tag on the elb if not already present
  mode:
    type: cloudtrail
    events:
       - CreateLoadBalancer
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-emr-auto-tag-user
  resource: aws.emr
  description: |
     Tags the user who creates the EMR
  mode:
      type: cloudtrail
      events:
        - source: elasticmapreduce.amazonaws.com
          event: RunJobFlow
          ids: "responseElements.jobFlowId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName




- name: aws-eni-auto-tag-user
  resource: aws.eni
  description: |
     Tags the user who creates the Elastic Network Interface
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: CreateNetworkInterface
          ids: "responseElements.networkInterface.networkInterfaceId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-event-bus-auto-tag-user
  resource: aws.event-bus
  description: |
     Tags the user who creates the AWS event bus
  mode:
      type: cloudtrail
      events:
        - source: events.amazonaws.com
          event: CreateEventBus
          ids: "requestParameters.name"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-event-rule-auto-tag-user
  resource: aws.event-rule
  description: |
     Tags the user who creates the AWS event rule
  mode:
      type: cloudtrail
      events:
        - source: events.amazonaws.com
          event: PutRule
          ids: "requestParameters.name"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-firehose-auto-tag-user
  resource: aws.firehose
  description: |
     Tags the user who creates the AWS Firehose
  mode:
      type: cloudtrail
      events:
        - source: firehose.amazonaws.com
          event: CreateDeliveryStream
          ids: "requestParameters.deliveryStreamName"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-fsx-auto-tag-user
  resource: aws.fsx
  description: |
     Tags the user who creates the AWS FSX filesystem
  mode:
      type: cloudtrail
      events:
        - source: fsx.amazonaws.com
          event: CreateFileSystem
          ids: "responseElements.fileSystem.fileSystemId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-fsx-backup-auto-tag-user
  resource: aws.fsx-backup
  description: |
     Tags the user who creates the AWS FSX filesystem backup
  mode:
      type: cloudtrail
      events:
        - source: fsx.amazonaws.com
          event: CreateBackup
          ids: "responseElements.backup.backupId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-es-auto-tag-user
  resource: aws.elasticsearch
  description: |
    Tags the creator's ID to the new Elasticsearch Domain
  mode:
    type: cloudtrail
    events:
        - CreateElasticsearchDomain
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-glacier-auto-tag-user
  resource: aws.glacier
  mode:
     type: cloudtrail
     events:
        - source: glacier.amazonaws.com
          event: CreateVault
          ids: "requestParameters.vaultName"
  description: |
     Tags the user who creates the Glacier Vault
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-glue-crawler-auto-tag-user
  resource: aws.glue-crawler
  description: |
     Tags the user who creates the AWS Glue crawler
  mode:
      type: cloudtrail
      events:
        - source: glue.amazonaws.com
          event: CreateCrawler
          ids: "requestParameters.name"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-glue-dev-endpoint-auto-tag-user
  resource: aws.glue-dev-endpoint
  description: |
     Tags the user who creates the AWS Glue Dev endpoint
  mode:
      type: cloudtrail
      events:
        - source: glue.amazonaws.com
          event: CreateDevEndpoint
          ids: "requestParameters.endpointName"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName




- name: aws-glue-job-auto-tag-user
  resource: aws.glue-job
  mode:
     type: cloudtrail
     events:
        - source: glue.amazonaws.com
          event: CreateJob
          ids: "requestParameters.name"
  description: |
     Tags the user who creates the Glue Job
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-glue-ml-transform-auto-tag-user
  resource: aws.glue-ml-transform
  description: |
     Tags the user who creates the AWS Glue ML transform
  mode:
      type: cloudtrail
      events:
        - source: glue.amazonaws.com
          event: CreateMLTransform
          ids: "responseElements.transformId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-glue-trigger-auto-tag-user
  resource: aws.glue-trigger
  description: |
     Tags the user who creates the AWS Glue trigger
  mode:
      type: cloudtrail
      events:
        - source: glue.amazonaws.com
          event: CreateTrigger
          ids: "requestParameters.name"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-glue-workflow-auto-tag-user
  resource: aws.glue-workflow
  description: |
     Tags the user who creates the AWS Glue workflow
  mode:
      type: cloudtrail
      events:
        - source: glue.amazonaws.com
          event: CreateWorkflow
          ids: "requestParameters.name"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-r53-hostedzone-auto-tag-user
  resource: aws.hostedzone
  description: |
     Tags the user who creates the AWS Route53 Hosted Zone
  mode:
      type: cloudtrail
      events:
        - source: route53.amazonaws.com
          event: CreateHostedZone
          ids: "responseElements.hostedZone.id"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-iam-role-auto-tag-user
  resource: aws.iam-role
  region: us-east-1
  description: |
     Tags the user who creates the AWS IAM Role
  mode:
      type: cloudtrail
      events:
        - source: iam.amazonaws.com
          event: CreateRole
          ids: "requestParameters.roleName"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-iam-user-auto-tag-user
  resource: aws.iam-user
  region: us-east-1
  description: |
     Tags the user who creates the AWS IAM User
  mode:
    type: cloudtrail
    events:
      - source: iam.amazonaws.com
        event: "CreateUser"
        ids: "responseElements.user.userName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-internet-gateway-auto-tag-user
  resource: aws.internet-gateway
  description: |
     Tags the user who creates the AWS Internet Gateway
  mode:
    type: cloudtrail
    events:
      - source: ec2.amazonaws.com
        event: "CreateInternetGateway"
        ids: "responseElements.internetGateway.internetGatewayId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-kafka-auto-tag-user
  resource: aws.kafka
  description: |
     Tags the user who creates the AWS Kafka cluster
  mode:
    type: cloudtrail
    events:
      - source: kafka.amazonaws.com
        event: "CreateCluster"
        ids: "responseElements.clusterArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-key-pair-auto-tag-user
  resource: aws.key-pair
  description: |
     Tags the user who creates the AWS Key Pair
  mode:
    type: cloudtrail
    events:
      - source: ec2.amazonaws.com
        event: "CreateKeyPair"
        ids: "requestParameters.keyName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-kinesis-auto-tag-user
  resource: aws.kinesis
  description: |
     Tags the user who creates the AWS Kinesis stream
  mode:
    type: cloudtrail
    events:
      - source: kinesis.amazonaws.com
        event: "CreateStream"
        ids: "requestParameters.streamName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-kinesis-analytics-auto-tag-user
  resource: aws.kinesis-analytics
  description: |
     Tags the user who creates the AWS Kinesis Analytics application
  mode:
    type: cloudtrail
    events:
      - source: kinesisanalytics.amazonaws.com
        event: "CreateApplication"
        ids: "requestParameters.applicationName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-kinesis-video-auto-tag-user
  resource: aws.kinesis-video
  description: |
     Tags the user who creates the AWS Kinesis video stream
  mode:
    type: cloudtrail
    events:
      - source: kinesisvideo.amazonaws.com
        event: "CreateStream"
        ids: "requestParameters.streamName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-kms-auto-tag-user
  resource: aws.kms-key
  description: |
    Tags the creator of a KMS key to the key itself
  mode:
      type: cloudtrail
      events:
        - source: kms.amazonaws.com
          event: CreateKey
          ids: "responseElements.keyMetadata.arn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-lambda-auto-tag-user
  resource: aws.lambda
  description: |
     Tag any new lambda function with the Creators ID
  mode:
    type: cloudtrail
    events:
        - source: lambda.amazonaws.com
          event: CreateFunction20150331
          ids: "requestParameters.functionName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-launch-template-version-auto-tag-user
  resource: aws.launch-template-version
  description: |
     Tags the user who creates the AWS Launch Template version
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateLaunchTemplateVersion
          ids: "requestParameters.launchTemplateId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-log-group-auto-tag-user
  resource: aws.log-group
  description: |
     Tags the user who creates the AWS Log Group
  mode:
    type: cloudtrail
    events:
        - source: logs.amazonaws.com
          event: CreateLogGroup
          ids: "requestParameters.logGroupName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-mq-auto-tag-user
  resource: aws.message-broker
  description: |
     Tag any new message-broker with the Creators ID.
  mode:
    type: cloudtrail
    events:
        - source: mq.amazonaws.com
          event: CreateBroker
          ids: "responseElements.brokerId"
  filters:
    - tag:CreatorName: absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-message-config-auto-tag-user
  resource: aws.message-config
  description: |
     Tags the user who creates the AWS MQ Configuration
  mode:
    type: cloudtrail
    events:
        - source: mq.amazonaws.com
          event: CreateConfiguration
          ids: "responseElements.id"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName







- name: aws-nat-gateway-auto-tag-user
  resource: aws.nat-gateway
  description: |
     Tags the user who creates the AWS NAT Gateway
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateNatGateway
          ids: "responseElements.natGateway.natGatewayId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-network-acl-auto-tag-user
  resource: aws.network-acl
  description: |
     Tags the user who creates the AWS network ACL
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateNetworkAcl
          ids: "responseElements.networkAcl.networkAclId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-peering-connection-auto-tag-user
  resource: aws.peering-connection
  description: |
     Tags the user who creates the AWS VPC peering connection
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateVpcPeeringConnection
          ids: "responseElements.vpcPeeringConnection.vpcPeeringConnectionId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-qldb-auto-tag-user
  resource: aws.qldb
  description: |
     Tags the user who creates the AWS QLDB Ledger
  mode:
    type: cloudtrail
    events:
        - source: qldb.amazonaws.com
          event: CreateLedger
          ids: "requestParameters.name"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-r53domain-auto-tag-user
  resource: aws.r53domain
  description: |
     Tags the user who creates the AWS Route53 Domain
  mode:
    type: cloudtrail
    events:
        - source: route53domains.amazonaws.com
          event: RegisterDomain
          ids: "requestParameters.domainName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-rds-cluster-auto-tag-owner
  description: |
    Tags any newly created RDS Cluster with CreatorName identifier
  resource: aws.rds-cluster
  mode:
     type: cloudtrail
     events:
        - source: rds.amazonaws.com
          event: CreateDBCluster
          ids: "requestParameters.dBClusterIdentifier"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-rds-auto-tag-owner
  description: |
    Tags any newly created RDS with CreatorName identifier
  resource: aws.rds
  mode:
     type: cloudtrail
     events:
        - source: rds.amazonaws.com
          event: CreateDBInstance
          ids: "requestParameters.dBInstanceIdentifier"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-rds-cluster-param-group-auto-tag-user
  resource: aws.rds-cluster-param-group
  description: |
     Tags the user who creates the AWS RDS Cluster Parameter Group
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateDBClusterParameterGroup
          ids: "requestParameters.dBClusterParameterGroupName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-rds-cluster-snapshot-auto-tag-user
  resource: aws.rds-cluster-snapshot
  description: |
     Tags the user who creates the AWS RDS Cluster Snapshot
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateDBClusterSnapshot
          ids: "requestParameters.dBClusterSnapshotIdentifier"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-rds-param-group-auto-tag-user
  resource: aws.rds-param-group
  description: |
     Tags the user who creates the AWS RDS Parameter Group
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateDBParameterGroup
          ids: "requestParameters.dBParameterGroupName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName

#rds-reserved






- name: aws-rds-snapshot-auto-tag-user
  resource: aws.rds-snapshot
  description: |
     Tags the user who creates the AWS RDS Snapshot
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateDBSnapshot
          ids: "requestParameters.dBSnapshotIdentifier"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName







- name: aws-rds-subnet-group-auto-tag-user
  resource: aws.rds-subnet-group
  description: |
     Tags the user who creates the AWS RDS Subnet Group
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateDBSubnetGroup
          ids: "requestParameters.dBSubnetGroupName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-rds-subscription-auto-tag-user
  resource: aws.rds-subscription
  description: |
     Tags the user who creates the AWS RDS Event Subscription
  mode:
    type: cloudtrail
    events:
        - source: rds.amazonaws.com
          event: CreateEventSubscription
          ids: "responseElements.eventSubscription.custSubscriptionId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-redshift-auto-tag-user
  mode:
    type: cloudtrail
    events:
        - source: redshift.amazonaws.com
          event: CreateCluster
          ids: 'responseElements.clusterIdentifier'
  resource: aws.redshift
  description: |
    Tags the creator of the Redshift Cluster
  filters:
   - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-redshift-snapshot-auto-tag-user
  resource: aws.redshift-snapshot
  description: |
     Tags the user who creates the AWS Redshift Snapshot
  mode:
    type: cloudtrail
    events:
        - source: redshift.amazonaws.com
          event: CreateClusterSnapshot
          ids: "requestParameters.snapshotIdentifier"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-redshift-subnet-group-auto-tag-user
  resource: aws.redshift-subnet-group
  description: |
     Tags the user who creates the AWS Redshift Subnet Group
  mode:
    type: cloudtrail
    events:
        - source: redshift.amazonaws.com
          event: CreateClusterSubnetGroup
          ids: "requestParameters.clusterSubnetGroupName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-rest-api-auto-tag-user
  resource: aws.rest-api
  description: |
    Tags the user who creates the API Gateway Rest API.
  mode:
      type: cloudtrail
      events:
        - source: apigateway.amazonaws.com
          event: CreateRestApi
          ids: 'responseElements.restapiUpdate.restApiId'
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName









- name: aws-route-table-auto-tag-user
  resource: aws.route-table
  description: |
     Tags the user who creates the AWS Route Table
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateRouteTable
          ids: "responseElements.routeTable.routeTableId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-s3-auto-tag-user
  resource: aws.s3
  description: |
    Tags the CreatorName to the new S3 bucket
  mode:
    type: cloudtrail
    events:
      - CreateBucket
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-sagemaker-endpoint-auto-tag-user
  resource: aws.sagemaker-endpoint
  description: |
     Tags the user who creates the AWS Sagemaker Endpoint
  mode:
    type: cloudtrail
    events:
        - source: sagemaker.amazonaws.com
          event: CreateEndpoint
          ids: "requestParameters.endpointName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-sagemaker-endpoint-config-auto-tag-user
  resource: aws.sagemaker-endpoint-config
  description: |
     Tags the user who creates the AWS Sagemaker Endpoint Config
  mode:
    type: cloudtrail
    events:
        - source: sagemaker.amazonaws.com
          event: CreateEndpointConfig
          ids: "requestParameters.endpointConfigName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-sagemaker-job-auto-tag-user
  resource: aws.sagemaker-job
  description: |
     Tags the user who creates the AWS Sagemaker Training Job
  mode:
    type: cloudtrail
    events:
        - source: sagemaker.amazonaws.com
          event: CreateTrainingJob
          ids: "requestParameters.trainingJobName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-sagemaker-model-auto-tag-user
  resource: aws.sagemaker-model
  description: |
     Tags the user who creates the AWS Sagemaker Model
  mode:
    type: cloudtrail
    events:
        - source: sagemaker.amazonaws.com
          event: CreateModel
          ids: "requestParameters.modelName"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName





- name: aws-sagemaker-notebook-auto-tag-user
  resource: aws.sagemaker-notebook
  description: |
    Tags the CreatorName to the new Sagemaker Notebook
  mode:
      type: cloudtrail
      events:
        - source: sagemaker.amazonaws.com
          event: CreateNotebookInstance
          ids: "responseElements.notebookInstanceArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-sagemaker-transform-job-auto-tag-user
  resource: aws.sagemaker-transform-job
  description: |
     Tags the user who creates the AWS Sagemaker Transform Job
  mode:
    type: cloudtrail
    events:
        - source: sagemaker.amazonaws.com
          event: CreateTransformJob
          ids: "responseElements.transformJobArn"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName







- name: aws-secrets-manager-auto-tag-user
  resource: aws.secrets-manager
  description: |
     Tags the user who creates the AWS Secrets Manager Secret
  mode:
    type: cloudtrail
    events:
        - source: secretsmanager.amazonaws.com
          event: PutSecretValue
          ids: "requestParameters.secretId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName



- name: aws-sg-auto-tag-user
  resource: aws.security-group
  description: |
    Creates a Tag called CreatorName with a value of the user who created the Security Group
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: CreateSecurityGroup
          ids: "responseElements.groupId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName



- name: aws-sg-auto-tag-last-modified-by-user
  resource: aws.security-group
  description: |
    Creates a Tag called LastModifiedByUser with a value of the user who last modified the Security Group
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: AuthorizeSecurityGroupIngress
          ids: "requestParameters.groupId"
        - source: ec2.amazonaws.com
          event: AuthorizeSecurityGroupEgress
          ids: "requestParameters.groupId"
        - source: ec2.amazonaws.com
          event: RevokeSecurityGroupEgress
          ids: "requestParameters.groupId"
        - source: ec2.amazonaws.com
          event: RevokeSecurityGroupIngress
          ids: "requestParameters.groupId"
  actions:
    - type: auto-tag-user
      tag: LastModifiedByUser





- name: aws-sns-auto-tag-user
  resource: aws.sns
  description: |
    Tags the user who creates the SNS topic.
  mode:
      type: cloudtrail
      events:
        - source: sns.amazonaws.com
          event: CreateTopic
          ids: 'responseElements.topicArn'
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-sqs-auto-tag-user
  resource: aws.sqs
  description: |
    Tags the user who creates the SQS Queue
  mode:
      type: cloudtrail
      events:
        - source: sqs.amazonaws.com
          event: CreateQueue
          ids: 'responseElements.queueUrl'
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName






- name: aws-ssm-parameter-auto-tag-user
  resource: aws.ssm-parameter
  description: |
     Tags the user who creates the AWS SSM Parameter
  mode:
    type: cloudtrail
    events:
        - source: ssm.amazonaws.com
          event: PutParameter
          ids: "requestParameters.name"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-step-functions-auto-tag-user
  resource: aws.step-machine
  description: |
    Tags the user who creates the step function.
  mode:
      type: cloudtrail
      events:
        - source: states.amazonaws.com
          event: CreateStateMachine
          ids: "responseElements.stateMachineArn"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName







- name: aws-streaming-distribution-auto-tag-user
  resource: aws.streaming-distribution
  description: |
     Tags the user who creates the AWS CloudFront Streaming Distribution
  mode:
    type: cloudtrail
    events:
        - source: cloudfront.amazonaws.com
          event: CreateStreamingDistribution
          ids: "responseElements.streamingDistribution.id"
        - source: cloudfront.amazonaws.com
          event: CreateStreamingDistributionWithTags
          ids: "responseElements.streamingDistribution.id"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-vpc-subnet-auto-tag-user
  resource: aws.subnet
  description: |
    Tags the user who created the Subnet at creation.
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: CreateSubnet
          ids: "responseElements.subnet.subnetId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-transit-gateway-auto-tag-user
  resource: aws.transit-gateway
  description: |
     Tags the user who creates the AWS VPC Transit Gateway
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateTransitGateway
          ids: "responseElements.transitGateway.transitGatewayId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName




- name: aws-vpc-auto-tag-user
  resource: vpc
  description: |
    Tags the user who creates the vpc.
  mode:
      type: cloudtrail
      events:
        - source: ec2.amazonaws.com
          event: CreateVpc
          ids: "responseElements.vpc.vpcId"
  filters:
   - "tag:CreatorName": absent
  actions:
   - type: auto-tag-user
     tag: CreatorName





- name: aws-vpc-endpoint-auto-tag-user
  resource: aws.vpc-endpoint
  description: |
     Tags the user who creates the AWS VPC Endpoint
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateVpcEndpoint
          ids: "responseElements.vpcEndpoint.vpcEndpointId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-vpn-connection-auto-tag-user
  resource: aws.vpn-connection
  description: |
     Tags the user who creates the AWS VPN connection
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateVpnConnection
          ids: "responseElements.vpnConnection.vpnConnectionId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-vpn-gateway-auto-tag-user
  resource: aws.vpn-gateway
  description: |
     Tags the user who creates the AWS VPN Gateway
  mode:
    type: cloudtrail
    events:
        - source: ec2.amazonaws.com
          event: CreateVpnGateway
          ids: "responseElements.vpnGateway.vpnGatewayId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName







- name: aws-waf-regional-auto-tag-user
  resource: aws.waf-regional
  description: |
     Tags the user who creates the AWS regional WAF Web ACL
  mode:
    type: cloudtrail
    events:
        - source: waf-regional.amazonaws.com
          event: CreateWebACL
          ids: "responseElements.webACL.webACLId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName






- name: aws-workspaces-auto-tag-user
  resource: aws.workspaces
  description: |
     Tags the user who creates the AWS Workspace
  mode:
    type: cloudtrail
    events:
        - source: workspaces.amazonaws.com
          event: CreateWorkspaces
          ids: "responseElements.pendingRequests[].workspaceId"
  filters:
    - "tag:CreatorName": absent
  actions:
    - type: auto-tag-user
      tag: CreatorName
